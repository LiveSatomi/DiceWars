<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_25) on Sun Mar 01 13:36:24 EST 2015 -->
<title>PackageManagerBackupAgent</title>
<meta name="date" content="2015-03-01">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PackageManagerBackupAgent";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/android/server/NsdService.html" title="class in com.android.server"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/android/server/PackageManagerBackupAgent.Metadata.html" title="class in com.android.server"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/android/server/PackageManagerBackupAgent.html" target="_top">Frames</a></li>
<li><a href="PackageManagerBackupAgent.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#fields.inherited.from.class.android.app.backup.BackupAgent">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.android.server</div>
<h2 title="Class PackageManagerBackupAgent" class="title">Class PackageManagerBackupAgent</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>android.content.Context</li>
<li>
<ul class="inheritance">
<li>android.content.ContextWrapper</li>
<li>
<ul class="inheritance">
<li>android.app.backup.BackupAgent</li>
<li>
<ul class="inheritance">
<li>com.android.server.PackageManagerBackupAgent</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">PackageManagerBackupAgent</span>
extends android.app.backup.BackupAgent</pre>
<div class="block">We back up the signatures of each package so that during a system restore,
 we can verify that the app whose data we think we have matches the app
 actually resident on the device.

 Since the Package Manager isn't a proper "application" we just provide a
 direct IBackupAgent implementation and hand-construct it at need.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/android/server/PackageManagerBackupAgent.Metadata.html" title="class in com.android.server">PackageManagerBackupAgent.Metadata</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.android.app.backup.BackupAgent">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;android.app.backup.BackupAgent</h3>
<code>TYPE_DIRECTORY, TYPE_EOF, TYPE_FILE, TYPE_SYMLINK</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.android.content.Context">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;android.content.Context</h3>
<code>ACCESSIBILITY_SERVICE, ACCOUNT_SERVICE, ACTIVITY_SERVICE, ALARM_SERVICE, APP_OPS_SERVICE, APPWIDGET_SERVICE, AUDIO_SERVICE, BACKUP_SERVICE, BIND_ABOVE_CLIENT, BIND_ADJUST_WITH_ACTIVITY, BIND_ALLOW_OOM_MANAGEMENT, BIND_AUTO_CREATE, BIND_DEBUG_UNBIND, BIND_IMPORTANT, BIND_NOT_FOREGROUND, BIND_NOT_VISIBLE, BIND_VISIBLE, BIND_WAIVE_PRIORITY, BLUETOOTH_SERVICE, CLIPBOARD_SERVICE, CONNECTIVITY_SERVICE, CONTEXT_IGNORE_SECURITY, CONTEXT_INCLUDE_CODE, CONTEXT_RESTRICTED, COUNTRY_DETECTOR, DEVICE_POLICY_SERVICE, DISPLAY_SERVICE, DOWNLOAD_SERVICE, DROPBOX_SERVICE, INPUT_METHOD_SERVICE, INPUT_SERVICE, KEYGUARD_SERVICE, LAYOUT_INFLATER_SERVICE, LOCATION_SERVICE, MEDIA_ROUTER_SERVICE, MODE_APPEND, MODE_ENABLE_WRITE_AHEAD_LOGGING, MODE_MULTI_PROCESS, MODE_PRIVATE, MODE_WORLD_READABLE, MODE_WORLD_WRITEABLE, NETWORK_POLICY_SERVICE, NETWORK_STATS_SERVICE, NETWORKMANAGEMENT_SERVICE, NFC_SERVICE, NOTIFICATION_SERVICE, NSD_SERVICE, POWER_SERVICE, SCHEDULING_POLICY_SERVICE, SEARCH_SERVICE, SENSOR_SERVICE, SERIAL_SERVICE, SIP_SERVICE, STATUS_BAR_SERVICE, STORAGE_SERVICE, TELEPHONY_SERVICE, TEXT_SERVICES_MANAGER_SERVICE, UI_MODE_SERVICE, UPDATE_LOCK_SERVICE, USB_SERVICE, USER_SERVICE, VIBRATOR_SERVICE, WALLPAPER_SERVICE, WIFI_P2P_SERVICE, WIFI_SERVICE, WINDOW_SERVICE</code></li>
</ul>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../com/android/server/PackageManagerBackupAgent.Metadata.html" title="class in com.android.server">PackageManagerBackupAgent.Metadata</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/android/server/PackageManagerBackupAgent.html#getRestoredMetadata-java.lang.String-">getRestoredMetadata</a></span>(java.lang.String&nbsp;packageName)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.Set&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/android/server/PackageManagerBackupAgent.html#getRestoredPackages--">getRestoredPackages</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/android/server/PackageManagerBackupAgent.html#hasMetadata--">hasMetadata</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/android/server/PackageManagerBackupAgent.html#onBackup-android.os.ParcelFileDescriptor-android.app.backup.BackupDataOutput-android.os.ParcelFileDescriptor-">onBackup</a></span>(android.os.ParcelFileDescriptor&nbsp;oldState,
        android.app.backup.BackupDataOutput&nbsp;data,
        android.os.ParcelFileDescriptor&nbsp;newState)</code>
<div class="block">The application is being asked to write any data changed since the last
 time it performed a backup operation.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/android/server/PackageManagerBackupAgent.html#onRestore-android.app.backup.BackupDataInput-int-android.os.ParcelFileDescriptor-">onRestore</a></span>(android.app.backup.BackupDataInput&nbsp;data,
         int&nbsp;appVersionCode,
         android.os.ParcelFileDescriptor&nbsp;newState)</code>
<div class="block">The application is being restored from backup and should replace any
 existing data with the contents of the backup.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.android.app.backup.BackupAgent">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;android.app.backup.BackupAgent</h3>
<code>attach, fullBackupFile, fullBackupFileTree, onBind, onCreate, onDestroy, onFullBackup, onRestoreFile, onRestoreFile</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.android.content.ContextWrapper">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;android.content.ContextWrapper</h3>
<code>attachBaseContext, bindService, bindServiceAsUser, checkCallingOrSelfPermission, checkCallingOrSelfUriPermission, checkCallingPermission, checkCallingUriPermission, checkPermission, checkUriPermission, checkUriPermission, clearWallpaper, createConfigurationContext, createDisplayContext, createPackageContext, createPackageContextAsUser, databaseList, deleteDatabase, deleteFile, enforceCallingOrSelfPermission, enforceCallingOrSelfUriPermission, enforceCallingPermission, enforceCallingUriPermission, enforcePermission, enforceUriPermission, enforceUriPermission, fileList, getApplicationContext, getApplicationInfo, getAssets, getBaseContext, getBasePackageName, getCacheDir, getClassLoader, getCompatibilityInfo, getContentResolver, getDatabasePath, getDir, getExternalCacheDir, getExternalFilesDir, getFilesDir, getFileStreamPath, getMainLooper, getObbDir, getPackageCodePath, getPackageManager, getPackageName, getPackageResourcePath, getResources, getSharedPreferences, getSharedPrefsFile, getSystemService, getTheme, getThemeResId, getUserId, getWallpaper, getWallpaperDesiredMinimumHeight, getWallpaperDesiredMinimumWidth, grantUriPermission, isRestricted, openFileInput, openFileOutput, openOrCreateDatabase, openOrCreateDatabase, peekWallpaper, registerReceiver, registerReceiver, registerReceiverAsUser, removeStickyBroadcast, removeStickyBroadcastAsUser, revokeUriPermission, sendBroadcast, sendBroadcast, sendBroadcast, sendBroadcastAsUser, sendBroadcastAsUser, sendOrderedBroadcast, sendOrderedBroadcast, sendOrderedBroadcast, sendOrderedBroadcastAsUser, sendStickyBroadcast, sendStickyBroadcastAsUser, sendStickyOrderedBroadcast, sendStickyOrderedBroadcastAsUser, setTheme, setWallpaper, setWallpaper, startActivities, startActivities, startActivitiesAsUser, startActivity, startActivity, startActivityAsUser, startActivityAsUser, startInstrumentation, startIntentSender, startIntentSender, startService, startServiceAsUser, stopService, stopServiceAsUser, unbindService, unregisterReceiver</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.android.content.Context">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;android.content.Context</h3>
<code>getString, getString, getText, obtainStyledAttributes, obtainStyledAttributes, obtainStyledAttributes, obtainStyledAttributes, registerComponentCallbacks, unregisterComponentCallbacks</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="hasMetadata--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasMetadata</h4>
<pre>public&nbsp;boolean&nbsp;hasMetadata()</pre>
</li>
</ul>
<a name="getRestoredMetadata-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRestoredMetadata</h4>
<pre>public&nbsp;<a href="../../../com/android/server/PackageManagerBackupAgent.Metadata.html" title="class in com.android.server">PackageManagerBackupAgent.Metadata</a>&nbsp;getRestoredMetadata(java.lang.String&nbsp;packageName)</pre>
</li>
</ul>
<a name="getRestoredPackages--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRestoredPackages</h4>
<pre>public&nbsp;java.util.Set&lt;java.lang.String&gt;&nbsp;getRestoredPackages()</pre>
</li>
</ul>
<a name="onBackup-android.os.ParcelFileDescriptor-android.app.backup.BackupDataOutput-android.os.ParcelFileDescriptor-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onBackup</h4>
<pre>public&nbsp;void&nbsp;onBackup(android.os.ParcelFileDescriptor&nbsp;oldState,
                     android.app.backup.BackupDataOutput&nbsp;data,
                     android.os.ParcelFileDescriptor&nbsp;newState)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code>android.app.backup.BackupAgent</code></span></div>
<div class="block">The application is being asked to write any data changed since the last
 time it performed a backup operation. The state data recorded during the
 last backup pass is provided in the <code>oldState</code> file
 descriptor. If <code>oldState</code> is <code>null</code>, no old state
 is available and the application should perform a full backup. In both
 cases, a representation of the final backup state after this pass should
 be written to the file pointed to by the file descriptor wrapped in
 <code>newState</code>.
 <p>
 Each entity written to the <code>BackupDataOutput</code>
 <code>data</code> stream will be transmitted
 over the current backup transport and stored in the remote data set under
 the key supplied as part of the entity.  Writing an entity with a negative
 data size instructs the transport to delete whatever entity currently exists
 under that key from the remote data set.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>onBackup</code>&nbsp;in class&nbsp;<code>android.app.backup.BackupAgent</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>oldState</code> - An open, read-only ParcelFileDescriptor pointing to the
            last backup state provided by the application. May be
            <code>null</code>, in which case no prior state is being
            provided and the application should perform a full backup.</dd>
<dd><code>data</code> - A structured wrapper around an open, read/write
            file descriptor pointing to the backup data destination.
            Typically the application will use backup helper classes to
            write to this file.</dd>
<dd><code>newState</code> - An open, read/write ParcelFileDescriptor pointing to an
            empty file. The application should record the final backup
            state here after writing the requested data to the <code>data</code>
            output stream.</dd>
</dl>
</li>
</ul>
<a name="onRestore-android.app.backup.BackupDataInput-int-android.os.ParcelFileDescriptor-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>onRestore</h4>
<pre>public&nbsp;void&nbsp;onRestore(android.app.backup.BackupDataInput&nbsp;data,
                      int&nbsp;appVersionCode,
                      android.os.ParcelFileDescriptor&nbsp;newState)
               throws java.io.IOException</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code>android.app.backup.BackupAgent</code></span></div>
<div class="block">The application is being restored from backup and should replace any
 existing data with the contents of the backup. The backup data is
 provided through the <code>data</code> parameter. Once
 the restore is finished, the application should write a representation of
 the final state to the <code>newState</code> file descriptor.
 <p>
 The application is responsible for properly erasing its old data and
 replacing it with the data supplied to this method. No "clear user data"
 operation will be performed automatically by the operating system. The
 exception to this is in the case of a failed restore attempt: if
 onRestore() throws an exception, the OS will assume that the
 application's data may now be in an incoherent state, and will clear it
 before proceeding.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>onRestore</code>&nbsp;in class&nbsp;<code>android.app.backup.BackupAgent</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>data</code> - A structured wrapper around an open, read-only
            file descriptor pointing to a full snapshot of the
            application's data.  The application should consume every
            entity represented in this data stream.</dd>
<dd><code>appVersionCode</code> - The value of the <a
 href="../../..guide/topics/manifest/manifest-element.html#vcode"><code>android:versionCode</code></a> manifest attribute,
            from the application that backed up this particular data set. This
            makes it possible for an application's agent to distinguish among any
            possible older data versions when asked to perform the restore
            operation.</dd>
<dd><code>newState</code> - An open, read/write ParcelFileDescriptor pointing to an
            empty file. The application should record the final backup
            state here after restoring its data from the <code>data</code> stream.
            When a full-backup dataset is being restored, this will be <code>null</code>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/android/server/NsdService.html" title="class in com.android.server"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/android/server/PackageManagerBackupAgent.Metadata.html" title="class in com.android.server"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/android/server/PackageManagerBackupAgent.html" target="_top">Frames</a></li>
<li><a href="PackageManagerBackupAgent.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#fields.inherited.from.class.android.app.backup.BackupAgent">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
